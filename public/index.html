<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="e-favicon.ico">

    <title>WeList</title>

    <!-- Bootstrap core CSS -->
    <link href="https://v4-alpha.getbootstrap.com/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/css/carousel4.css" rel="stylesheet">

        <!-- jQuery library -->
  <script src="https://code.jquery.com/jquery.js"></script>

   
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://v4-alpha.getbootstrap.com/dist/js/bootstrap.min.js"></script>
    <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
    <script src="https://v4-alpha.getbootstrap.com/assets/js/vendor/holder.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="https://v4-alpha.getbootstrap.com/assets/js/ie10-viewport-bug-workaround.js"></script>

    <script src="/js/jquery.mobile.custom.js"></script>
    <script src="/js/jquery.mobile.custom.min.js"></script>
    <script src="/js/startup.js"></script>

<style>
body {
padding-top: 1em;
} 
.card-columns {
    @include media-breakpoint-only(sm) {
    column-count: 1;
  }
  @include media-breakpoint-only(md) {
    column-count: 2;
  }
  @include media-breakpoint-only(lg) {
    column-count: 4;
  }
}
</style>

  </head>
  <body>

    <nav class="navbar navbar-toggleable-md navbar-inverse fixed-top bg-inverse">
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <a class="navbar-brand" href="#">WeList</a>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="#">Discover </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Create </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">My Lists</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Login</a>
          </li>
        </ul>
        <form class="form-inline mt-2 mt-md-0">
          <input class="form-control mr-sm-2" type="text" placeholder="Search">
          <button class="btn btn-outline-danger my-2 my-sm-0" type="submit">Search</button>
        </form>
      </div>
    </nav>

    <div id="myCarousel" class="carousel slide" data-ride="carousel">
      <ol class="carousel-indicators">
        <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
        <li data-target="#myCarousel" data-slide-to="1"></li>
        <li data-target="#myCarousel" data-slide-to="2"></li>
      </ol>
      <div class="carousel-inner" role="listbox">
        <div class="carousel-item active">
          <img class="first-slide" src="img/beach.jpg" alt="First slide">
          <div class="container">
            <div class="carousel-caption">
           <h1><img src="img/welist-logo-transp.png" height=40% width=40% alt="WeList Logo"></h1>
              <p>Your site for creating sharing and discovering lists</p><br>
              <p><a class="btn btn-lg btn-danger" href="timeline.html" role="button">Discover Lists</a> <a class="btn btn-lg btn-danger" href="#" role="button">Create a List</a></p><br><br><br>
            </div>
          </div>
        </div>
        <div class="carousel-item">
          <img class="second-slide" src="img/paris.jpg" alt="Second slide">
          <div class="container">
            <div class="carousel-caption">
              <h1><img src="img/welist-logo-transp.png" height=40% width=40% alt="WeList Logo"></h1>
              <p>Your site for creating sharing and discovering lists</p><br>
              <p><a class="btn btn-lg btn-danger" href="timeline.html" role="button">Discover Lists</a> <a class="btn btn-lg btn-danger" href="#" role="button">Create a List</a></p><br><br><br>
            </div>
          </div>
        </div>
        <div class="carousel-item">
          <img class="third-slide" src="img/festival.jpg" alt="Third slide">
          <div class="container">
            <div class="carousel-caption">
              <h1><img src="img/welist-logo-transp.png" height=40% width=40% alt="WeList Logo"></h1>
              <p>Your site for creating sharing and discovering lists</p><br>
              <p><a class="btn btn-lg btn-danger" href="timeline.html" role="button">Discover Lists</a> <a class="btn btn-lg btn-danger" href="#" role="button">Create a List</a></p><br><br><br>
            </div>
          </div>
        </div>
      </div>
      <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
      </a>
    </div>


    <div class="container marketing">

      <div class="container-fluid">
    
        <div class="card-columns" id="lists">

          <!-- list cards go here -->

        </div>

      </div>


      <!-- FOOTER -->
      <footer>
        <p class="float-right"><a href="#">Back to top</a></p>
        <p>&copy; 2017 Company, Inc. &middot; <a href="#">Privacy</a> &middot; <a href="#">Terms</a></p>
      </footer>

    </div><!-- /.container -->

    <!-- Modal -->
  <div id="listModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
         
          <h2 class="modal-title" id="listName"><strong>List Detail</strong></h2>
        </div>
        <div class="modal-body">
          <h2 ></h2>
          <img id="listImg" src="http://www.globeslcc.com/wp-content/uploads/media/anonymous_girl_facebook.jpg" alt="" style="height: auto; max-width: 100%">
          <p><div id="listItems"></div></p>
        </div>
        <div class="modal-footer">
          <button type="button" id="reset" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>

    </div>
  </div>


<script>

var listId = "";
var hString = "";
var cardName = "";
var cardImg = "";

console.log("in script");
$.get("/api/cards", function(listdata) {

  for (var i = 0; i < listdata.length; i++) {

    itemString = '<img src="' + listdata[i].list_photo + '" width="100%">';
    itemString += '<p>' + listdata[i].description + '</p>';
    listId = listdata[i].list_id;

    appendCard(listId, listdata[i].title, itemString);

  } // end for each lists


$(".myList").click(function(){

  hString = "";
  cardName = "";
  cardImg = "";

  listId = $(this).attr("id");

  console.log("\nlist_id: " + listId);

  $.get("/api/list/" + listId, function(carddata) {

        cardName = carddata[0].title;
        cardImg = carddata[0].list_photo; 

        console.log("list_id: " + listId);

      }).then($.get("/api/lists/" + listId, function(itemdata) {

        hString = '<ol>';      
    
        for (var i = 0; i < itemdata.length; i++) {

          hString += '<li>' + itemdata[i].item;

          } // end for each list_item

        hString += '</ol>';

        console.log("list_id: " + listId);

         $("#listName").text(cardName);
        $("#listImg").attr('src', cardImg);
        $("#listItems").html(hString);
        // Show the list modal
        $("#listModal").modal('toggle');

      })); // end chained ajax calls

  });   // end click event 

}); // end cards get  


function appendCard(list_id, title, content) {

    console.log("in appendCard");

    var h = '<div class="card myList" id="' + listId + '">';
    h += '<div class="card-header">' + title + '</div>';
    h += '<div class="card-block">'
    h += '<div class="card-text">';
    h += '<div class="panel-body">';
    h += content;
    h += '</div>';
    h += '</div>';
    h += '</div>';
    $("#lists").append(h);
            
} // end function appendCard

</script>

</body>
</html>
